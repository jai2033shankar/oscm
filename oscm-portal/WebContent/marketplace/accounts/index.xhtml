<!-- Copyright FUJITSU LIMITED 2020-->
<!DOCTYPE html>
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:mp="http://www.fujitsu.com/global/services/software/interstage/marketplace"
                xmlns:adm="http://www.fujitsu.com/global/services/software/interstage"
                xmlns:rich="http://richfaces.org/rich" xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:a4j="http://richfaces.org/a4j" template="../templates/mainBootstrap.xhtml">

  <ui:define name="pageId">
    <c:set var="pageId" value="marketplace.account"/>
    <c:set var="imgUrl" value="#{facesContext.externalContext.requestContextPath}/marketplace/img"/>
  </ui:define>

  <div class="row">
    <ui:define name="aside">
      <div class="col-3">
        <div class="list-group list-group-vertical-sm text-center" id="nav-account" role="tablist" aria-orientation="vertical">
          <a class="list-group-item list-group-item-secondary list-group-item-action active" id="tabIndex"
             data-toggle="tab" href="#index" role="tab" aria-controls="index">Home</a>
          <a class="list-group-item list-group-item-secondary list-group-item-action active" id="tabProfile"
             data-toggle="tab" href="#profile" role="tab" aria-controls="profile">Profile</a>
          <a class="list-group-item list-group-item-secondary list-group-item-action active" id="tabSettings"
             data-toggle="tab" href="#settings" role="tab" aria-controls="settings">Settings</a>
        </div>
      </div>
    </ui:define>

    <div class="col-9">
      <div class="tab-content" id="accountTabContent">
        <div id="index" class="tab-pane fade show active pt-4" role="tabpanel" aria-labelledby="nav-index-tab">
          <ui:define name="breadcrumbs">
            <mp:bootstrapBreadcrumbs menu="#{true}">
              <mp:crumb labelPageId="marketplace.account"/>
            </mp:bootstrapBreadcrumbs>
          </ui:define>

          <ui:define name="contents">
            <a4j:outputPanel id="all" layout="block">
              <div class="row mt-2">
                <a4j:outputPanel id="profile" layout="block" styleClass="col-md-6 col-lg-4 marginBottomDefault"
                                 rendered="#{empty appBean.hiddenUIElements['marketplace.navigation.Profile']}">

                  <div class="card h-100 selectable">
                    <div class="card-header">#{msg['marketplace.account.profile.title']}</div>
                    <div class="card-body">
                      <a4j:outputPanel layout="block" styleClass="accountBox">
                        <a4j:outputPanel id="userName" layout="block" styleClass="mb-2">
                          <h:outputText value="#{msg['user.salutation.MR']} "
                                        rendered="#{organizationBean.currentUser.salutation == 'MR'}"/>
                          <h:outputText value="#{msg['user.salutation.MS']} "
                                        rendered="#{organizationBean.currentUser.salutation == 'MS'}"/>
                          <h:outputText
                              value="#{organizationBean.currentUser.firstName} #{organizationBean.currentUser.lastName}"
                              rendered="#{not sessionBean.nameSequenceReversed}"/>
                          <h:outputText
                              value="#{organizationBean.currentUser.lastName} #{organizationBean.currentUser.firstName}"
                              rendered="#{sessionBean.nameSequenceReversed}"/>
                        </a4j:outputPanel>
                        <a4j:outputPanel layout="block" styleClass="mb-2">
                          <h:outputText value="#{organizationBean.currentUser.email}"/>
                        </a4j:outputPanel>
                        <a4j:outputPanel layout="block" id="organizationName" rendered="#{userBean.loggedInAndAdmin}">
                          <h:outputText value="#{organizationBean.organization.name}" styleClass="preWrapping"/>
                        </a4j:outputPanel>
                      </a4j:outputPanel>
                    </div>
                    <div class="card-footer bg-transparent">
                      <h:link id="editProfileButton" outcome="profile"
                              class="btn btn-sm btn-outline-secondary stretched-link"
                              value="#{msg['marketplace.account.button.show']}" onclick="AdmUtils.showProgress(true);"/>
                    </div>

                  </div>
                </a4j:outputPanel>

                <a4j:outputPanel id="payments" layout="block" styleClass="col-md-6 col-lg-4 marginBottomDefault"
                                 rendered="#{userBean.loggedInAndAdmin and empty appBean.hiddenUIElements['marketplace.navigation.Payment'] and appBean.paymentInfoAvailable}">

                  <div class="card h-100 selectable">
                    <div class="card-header">#{msg['marketplace.account.payments.title']}</div>
                    <div class="card-body">
                      <a4j:outputPanel layout="block" styleClass="accountBox">
                        <h:outputText value="#{msg['marketplace.account.payments.description']}"/>
                      </a4j:outputPanel>
                    </div>

                    <div class="card-footer bg-transparent">
                      <h:link id="showPaymentsButton" outcome="payments"
                              class="btn btn-sm btn-outline-secondary stretched-link"
                              value="#{msg['marketplace.account.button.show']}" onclick="AdmUtils.showProgress(true);"/>
                    </div>
                  </div>
                </a4j:outputPanel>

                <a4j:outputPanel id="subscriptions" layout="block" styleClass="col-md-6 col-lg-4 marginBottomDefault"
                                 rendered="#{(userBean.loggedInAndAdmin or userBean.loggedInAndSubscriptionManager or userBean.loggedInAndUnitAdmin) and empty appBean.hiddenUIElements['marketplace.navigation.Subscriptions']}">

                  <div class="card h-100 selectable">
                    <div class="card-header">#{msg['marketplace.account.subscriptions.title']}</div>
                    <div class="card-body">
                      <a4j:outputPanel layout="block" styleClass="accountBox">
                        <h:outputText value="#{msg['marketplace.account.subscriptions.description']}"/>
                      </a4j:outputPanel>
                    </div>

                    <div class="card-footer bg-transparent">
                      <h:link id="showSubscriptionsButton" outcome="subscriptions"
                              class="btn btn-sm btn-outline-secondary stretched-link"
                              value="#{msg['marketplace.account.button.show']}" onclick="AdmUtils.showProgress(true);"/>
                    </div>
                  </div>
                </a4j:outputPanel>

                <a4j:outputPanel id="users" layout="block" styleClass="col-md-6 col-lg-4 marginBottomDefault"
                                 rendered="#{userBean.loggedInAndAdmin and empty appBean.hiddenUIElements['marketplace.navigation.Users']}">

                  <div class="card h-100 selectable">
                    <div class="card-header">#{msg['marketplace.account.users.title']}</div>
                    <div class="card-body">
                      <a4j:outputPanel layout="block" styleClass="accountBox">
                        <h:outputText value="#{msg['marketplace.account.users.description']}"/>
                        <br/>
                        <br/>
                        <h:outputText value="#{msg['marketplace.account.users.group.description']}"/>
                      </a4j:outputPanel>
                    </div>

                    <div class="card-footer bg-transparent">
                      <h:link id="showUsersButton" outcome="users"
                              class="btn btn-sm btn-outline-secondary stretched-link"
                              value="#{msg['marketplace.account.button.show']}" onclick="AdmUtils.showProgress(true);"/>
                    </div>
                  </div>
                </a4j:outputPanel>

                <a4j:outputPanel id="units" layout="block" styleClass="col-md-6 col-lg-4 marginBottomDefault"
                                 rendered="#{userBean.loggedInAndUnitAdmin and empty appBean.hiddenUIElements['marketplace.navigation.Units']}">

                  <div class="card h-100 selectable">
                    <div class="card-header">#{msg['marketplace.account.units.title']}</div>
                    <div class="card-body">
                      <a4j:outputPanel layout="block" styleClass="accountBox">
                        <h:outputText value="#{msg['marketplace.account.units.description']}"/>
                      </a4j:outputPanel>
                    </div>
                    <div class="card-footer bg-transparent">
                      <h:link id="showUnitsButton" outcome="units"
                              class="btn btn-sm btn-outline-secondary stretched-link"
                              value="#{msg['marketplace.account.button.show']}" onclick="AdmUtils.showProgress(true);"/>
                    </div>
                  </div>
                </a4j:outputPanel>

                <a4j:outputPanel id="reports" layout="block" styleClass="col-md-6 col-lg-4 marginBottomDefault"
                                 rendered="#{accountNavigationBean.reportingAvailable}">

                  <div class="card h-100 selectable">
                    <div class="card-header">#{msg['marketplace.account.reports.title']}</div>
                    <div class="card-body">
                      <a4j:outputPanel layout="block" styleClass="accountBox">
                        <c:forEach items="#{reportBean.filteredReports}" var="report" varStatus="v">
                          <a4j:outputPanel layout="block" styleClass="mb-2">
                            <h:outputLink value="reports.jsf?sr=#{v.index}" id="reportLink#{v.index}">
                              <h:outputText value="#{report.localizedReportName}"/>
                              <br/>
                            </h:outputLink>
                          </a4j:outputPanel>
                        </c:forEach>
                      </a4j:outputPanel>
                    </div>
                    <div class="card-footer bg-transparent">
                      <h:link id="showReportsButton" outcome="reports"
                              class="btn btn-sm btn-outline-secondary stretched-link"
                              value="#{msg['marketplace.account.button.show']}" onclick="AdmUtils.showProgress(true);"/>
                    </div>
                  </div>
                </a4j:outputPanel>

                <a4j:outputPanel id="processes" layout="block" styleClass="col-md-6 col-lg-4 marginBottomDefault"
                                 rendered="#{empty appBean.hiddenUIElements['marketplace.navigation.Processes']}">

                  <div class="card h-100 selectable">
                    <div class="card-header">#{msg['marketplace.account.processes.title']}</div>
                    <div class="card-body">
                      <a4j:outputPanel layout="block" styleClass="accountBox">
                        <h:outputText value="#{msg['marketplace.account.processes.description']}"/>
                      </a4j:outputPanel>
                    </div>
                    <div class="card-footer bg-transparent">
                      <h:link id="showProcessesButton" outcome="processes"
                              class="btn btn-sm btn-outline-secondary stretched-link"
                              value="#{msg['marketplace.account.button.show']}" onclick="AdmUtils.showProgress(true);"/>
                    </div>
                  </div>
                </a4j:outputPanel>

                <a4j:outputPanel id="operations" layout="block" styleClass="col-md-6 col-lg-4 marginBottomDefault"
                                 rendered="#{empty appBean.hiddenUIElements['marketplace.navigation.Operations']}">

                  <div class="card h-100 selectable">
                    <div class="card-header">#{msg['marketplace.account.operations.title']}</div>
                    <div class="card-body">
                      <a4j:outputPanel layout="block" styleClass="accountBox">
                        <h:outputText value="#{msg['marketplace.account.operations.description']}"/>
                      </a4j:outputPanel>
                    </div>
                    <div class="card-footer bg-transparent">
                      <h:link id="showOperationsButton" outcome="operations"
                              class="btn btn-sm btn-outline-secondary stretched-link"
                              value="#{msg['marketplace.account.button.show']}" onclick="AdmUtils.showProgress(true);"/>
                    </div>
                  </div>
                </a4j:outputPanel>

                <a4j:outputPanel id="administration" layout="block" styleClass="col-md-6 col-lg-4 marginBottomDefault"
                                 rendered="#{userBean.administrationAccess and empty appBean.hiddenUIElements['marketplace.navigation.Administration']}">

                  <div class="card h-100 selectable">
                    <div class="card-header">#{msg['marketplace.account.administration.title']}</div>
                    <div class="card-body">
                      <a4j:outputPanel layout="block" styleClass="accountBox">
                        <h:outputText value="#{msg['marketplace.account.administration.description']}"/>
                      </a4j:outputPanel>
                    </div>
                    <div class="card-footer bg-transparent">
                      <h:link id="showAdministrationButton" class="btn btn-sm btn-outline-secondary stretched-link"
                              value="#{msg['marketplace.account.button.show']}"
                              onclick="AdmUtils.showProgress(true);location.href='#{userBean.adminPortalAddress}';return false;"/>
                    </div>
                  </div>
                </a4j:outputPanel>
              </div>
            </a4j:outputPanel>
          </ui:define>
        </div>
        <div id="profile" class="tab-pane fade show active pt-4" role="tabpanel" aria-labelledby="nav-profile-tab">
          <ui:define name="breadcrumbs">
            <adm:initialize initializingMethod="#{organizationBean.initialize}"/>
            <mp:bootstrapBreadcrumbs menu="#{true}">
              <mp:crumb labelPageId="marketplace.account" link="/marketplace/account/index.jsf"/>
              <mp:crumb labelPageId="#{pageId}"/>
            </mp:bootstrapBreadcrumbs>
          </ui:define>

          <ui:define name="contents">
            <h:form id="validateCurrentUserRolesForm">
              <a4j:jsFunction name="validateCurrentUserRoles" data="#{organizationBean.currentUserRolesChanged}"
                              oncomplete="if(event.data==true){#{rich:component('reLogining')}.show();}
                     else{setOnSubmit(true);setDirty(false);
                     #{rich:element('saveButton')}.click();setOnSubmit(false);} return false;">
              </a4j:jsFunction>
            </h:form>

            <div id="all" class="row">
              <div class="my-2 p-3 bg-light col">
                <mp:outputStep value="#{msg['marketplace.account.profile.title']}"/>

                <h:inputHidden value="#{sessionBean.selectedTab}"/>

                <div class="list-group list-group-horizontal-sm text-center" id="nav-tab" role="tablist">
                  <a class="list-group-item list-group-item-secondary list-group-item-action active" id="tabUser"
                     data-toggle="tab"
                     href="#user" role="tab" aria-controls="user"
                     onclick="setSelectedTab('tabUser');">#{msg['marketplace.account.profile.userTab']}</a>
                  <c:if
                      test="#{userBean.isOrganizationAdmin and empty appBean.hiddenUIElements['organization.edit.organizationData']}">
                    <a class="list-group-item list-group-item-secondary list-group-item-action" id="tabOrg"
                       data-toggle="tab"
                       href="#org" aria-controls="org" aria-selected="false"
                       role="tab" onclick="setSelectedTab('tabOrg');">#{msg['marketplace.account.profile.organizationTab']}</a>
                  </c:if>
                  <c:if test="#{userBean.isOrganizationAdmin}">
                    <a class="list-group-item list-group-item-secondary list-group-item-action" id="tabAttr"
                       data-toggle="tab"
                       aria-selected="false" role="tab" aria-controls="attr"
                       href="#attr" onclick="setSelectedTab('tabAttr');">#{msg['marketplace.account.profile.attributeTab']}</a>
                  </c:if>
                </div>

                <div class="tab-content" id="myTabContent">
                  <div id="user" class="tab-pane fade show active pt-4" role="tabpanel" aria-labelledby="nav-user-tab">
                    <h:form id="userForm">
                      <div class="row">
                        <div class="col-md-9">
                          <h2>
                            <adm:outputStep value="#{msg['organization.edit.userProfile']}"/>
                            <mp:pixelline
                                rendered="#{not organizationBean.currentUser.remoteLdapActive and userBean.internalAuthMode}"/>
                          </h2>
                        </div>
                        <a4j:outputPanel layout="block" styleClass="row col-md-3 justify-content-end"
                                         rendered="#{not organizationBean.currentUser.remoteLdapActive and userBean.internalAuthMode}">
                          <adm:buttonCustomizedOnClickBootstrap id="changePwdButton"
                                                                value="#{msg['button.changePassword']}"
                                                                onclick="showLoginPanel('');return false;"
                                                                buttonStyleClass="btn btn-sm btn-outline-secondary w-sm-100"
                                                                buttonType="execute"/>
                        </a4j:outputPanel>
                      </div>

                      <mp:formLabel id="userId" label="#{msg['user.userId']}"
                                    label2="#{organizationBean.currentUser.userId}"/>

                      <mp:formLabel id="userGroups" label="#{msg['user.userGroup']}"
                                    label2="#{organizationBean.currentUser.groupsToDisplay}"/>

                      <mp:formSelect id="salutation" label="#{msg['user.salutation']}"
                                     value="#{organizationBean.currentUser.salutation}" selectStyle="custom-select">
                        <adm:salutationItems/>
                      </mp:formSelect>

                      <mp:formUserName firstNameId="firstName"
                                       firstNameValue="#{organizationBean.currentUser.firstName}"
                                       lastNameId="lastName" lastNameValue="#{organizationBean.currentUser.lastName}"
                                       firstNameDisabled="#{organizationBean.currentUser.firstNameDisabled}"
                                       lastNameDisabled="#{organizationBean.currentUser.lastNameDisabled}"
                                       inputStyle="form-control"/>

                      <adm:formInput id="email" label="#{msg['user.email']}" required="true" inputStyle="form-control"
                                     value="#{organizationBean.currentUser.email}" maxlength="#{appBean.nameLen}"
                                     disabled="#{organizationBean.currentUser.emailDisabled}" validatorId="email"
                                     converterId="trimConverter"/>

                      <mp:formSelect id="locale" label="#{msg['user.locale']}" showHint="true"
                                     value="#{organizationBean.currentUser.locale}" selectStyle="custom-select">
                        <adm:localeItems/>
                        <f:validator validatorId="SupportedLanguageValidator"/>
                      </mp:formSelect>

                      <hr/>
                      <a4j:outputPanel styleClass="row justify-content-end">
                        <adm:buttonBootstrap id="saveUserButton" value="#{msg['button.save']}"
                                             bean="#{organizationBean}"
                                             onclick="validateCurrentUserRoles();return false;"
                                             styleClass="btn btn-secondary mr-4" action="save"/>
                      </a4j:outputPanel>
                    </h:form>
                  </div>

                  <div id="org" class="tab-pane fade pt-4" role="tabpanel" aria-labelledby="nav-org-tab">
                    <h:form id="orgForm">
                      <h2>
                        <adm:outputStep value="#{msg['organization.edit.organizationData']}"/>
                      </h2>
                      <hr/>

                      <mp:formLabel id="organizationId" label2="#{organizationBean.organization.organizationId}"
                                    label="#{msg['organization.organizationId']}"/>

                      <adm:formInput id="organizationName" label="#{msg['organization.name']}"
                                     converterId="trimConverter"
                                     required="#{organizationBean.currentUser.supplier or organizationBean.currentUser.technologyProvider}"
                                     value="#{organizationBean.organization.name}" inputStyle="form-control"
                                     maxlength="#{appBean.nameLen}"/>

                      <adm:formInput id="organizationEmail" label="#{msg['organization.email']}"
                                     inputStyle="form-control"
                                     required="#{organizationBean.currentUser.supplier or organizationBean.currentUser.technologyProvider}"
                                     onchange="setDirty(true)" value="#{organizationBean.organization.email}"
                                     maxlength="#{appBean.nameLen}" validatorId="email" converterId="trimConverter"/>

                      <adm:formTextarea id="organizationAddress" label="#{msg['organization.address']}"
                                        required="#{organizationBean.currentUser.supplier or organizationBean.currentUser.technologyProvider}"
                                        value="#{organizationBean.organization.address}" converterId="trimConverter"
                                        maxlength="#{appBean.descriptionLen}" areaStyle="form-control"/>

                      <mp:formSelect id="country" label="#{msg['common.country']}" selectStyle="custom-select"
                                     value="#{organizationBean.organization.domicileCountry}"
                                     required="true">
                        <adm:countryItems supportedCountries="#{countryBean.supportedCountryCodesForEditProfilePage}"/>
                      </mp:formSelect>

                      <hr/>
                      <a4j:outputPanel styleClass="row justify-content-end">
                        <adm:buttonBootstrap id="saveOrgButton" value="#{msg['button.save']}" bean="#{organizationBean}"
                                             action="save" onclick="validateCurrentUserRoles();return false;"
                                             styleClass="btn btn-secondary mr-4"/>
                      </a4j:outputPanel>
                    </h:form>
                  </div>

                  <div id="attr" class="tab-pane fade pt-4" role="tabpanel" aria-labelledby="nav-attr-tab">
                    <h:form id="attrForm">
                      <h2>
                        <adm:outputStep value="#{msg['marketplace.account.profile.attributes.title']}"/>
                      </h2>

                      <a4j:outputPanel id="attributesTablePanel" layout="block"
                                       styleClass="tablePanel table_padding minimumSizeTable">

                        <c:set var="sortIconAscending" value="/marketplace/img/transparentPixel.png?id=sortAscending"/>
                        <c:set var="sortIconDescending"
                               value="/marketplace/img/transparentPixel.png?id=sortDescending"/>

                        <rich:dataTable headerClass="rowTitle" rowClasses="rowOdd,rowEven" id="attributesTable"
                                        width="100%"
                                        rows="10" value="#{manageAttributesCtrl.model.attributes}" var="item"
                                        selectionMode="single" enableContextMenu="false" noDataLabel=" "
                                        columnClasses="alignTop wrapColumns preWrapping"
                                        styleClass="table table-striped table-hover table-bordered sortable"
                                        render="pagerPanel"
                                        rendered="#{(not empty manageAttributesCtrl.model.attributes)}"
                                        sortMode="single">

                          <rich:column styleClass="d-lg-none col-icon" headerClass="d-lg-none">
                            <rich:collapsibleSubTableToggler for="sbtbl"/>
                          </rich:column>

                          <rich:column id="colUdaName" width="#{mediumWidth}" sortBy="#{item.udaNameToShow}"
                                       sortIconAscending="#{sortIconAscending}"
                                       sortIconDescending="#{sortIconDescending}"
                                       sortOrder="#{tableState.sortOrders['mpColUdaName']}" sortIcon="#{sortIcon}"
                                       filterType="custom" filterValue="#{tableState.filterValues['colUdaName']}"
                                       filterExpression="#{adm:matchBegin(item.udaNameToShow, tableState.filterValues['colUdaName'], false)}">
                            <f:facet name="header">
                              <h:outputText value="#{msg['marketplace.account.profile.attributes.udaName']}"/>
                              <hr class="my-1"/>
                              <adm:filterInputBootstrap inputValue="#{tableState.filterValues['colUdaName']}"
                                                        render="attributesTable@body pagerPanel" inputId="filterUdaName"
                                                        onkeyup="AdmUtils.setFirstPage(#{rich:element('attributePager')});"/>
                            </f:facet>
                            <h:outputText value="#{item.udaNameToShow}"/>
                          </rich:column>

                          <rich:column id="colVendor" width="#{mediumWidth}" sortBy="#{item.vendor.name}"
                                       sortIcon="#{sortIcon}"
                                       sortIconAscending="#{sortIconAscending}"
                                       sortIconDescending="#{sortIconDescending}"
                                       sortOrder="#{tableState.sortOrders['mpColVendor']}"
                                       styleClass="d-none d-lg-table-cell"
                                       filterType="custom" filterValue="#{tableState.filterValues['colVendor']}"
                                       filterExpression="#{adm:matchBegin(item.vendor.name, tableState.filterValues['colVendor'], false)}"
                                       headerClass="d-none d-lg-table-cell">
                            <f:facet name="header">
                              <h:outputText value="#{msg['marketplace.account.profile.attributes.vendor']}"/>
                              <hr class="my-1"/>
                              <adm:filterInputBootstrap inputId="filterVendor"
                                                        inputValue="#{tableState.filterValues['colVendor']}"
                                                        render="attributesTable@body pagerPanel"
                                                        onkeyup="AdmUtils.setFirstPage(#{rich:element('attributePager')});"/>
                            </f:facet>
                            <h:outputText value="#{item.vendor.name}"/>
                          </rich:column>

                          <c:set var="scopeKey" value="UdaConfigurationType.#{item.udaDefinition.configurationType}"/>

                          <rich:column width="#{smallWidth}" sortBy="#{item.udaDefinition.configurationType}"
                                       sortIcon="#{sortIcon}"
                                       sortIconAscending="#{sortIconAscending}"
                                       sortIconDescending="#{sortIconDescending}"
                                       styleClass="d-none d-sm-table-cell"
                                       headerClass="align-top d-none d-sm-table-cell">
                            <f:facet name="header">
                              <h:outputText value="#{msg['marketplace.account.profile.attributes.scope']}"/>
                              <hr class="my-1"/>
                            </f:facet>
                            <h:outputText value="#{msg[scopeKey]}"/>
                          </rich:column>

                          <rich:column id="colUdaValue" width="#{restWidth}" sortBy="#{item.udaValue}"
                                       sortIcon="#{sortIcon}"
                                       sortIconAscending="#{sortIconAscending}"
                                       sortIconDescending="#{sortIconDescending}"
                                       sortOrder="#{tableState.sortOrders['mpColUdaValue']}" styleClass="p-1"
                                       filterType="custom" filterValue="#{tableState.filterValues['colUdaValue']}"
                                       filterExpression="#{adm:matchBegin(item.udaValueToShow, tableState.filterValues['colUdaValue'], false)}">
                            <f:facet name="header">
                              <h:outputText value="#{msg['marketplace.account.profile.attributes.value']}"/>
                              <hr class="my-1"/>
                              <adm:filterInputBootstrap inputValue="#{tableState.filterValues['colUdaValue']}"
                                                        render="attributesTable@body pagerPanel"
                                                        inputId="filterUdaValue"
                                                        onkeyup="AdmUtils.setFirstPage(#{rich:element('attributePager')});"/>
                            </f:facet>
                            <h:inputText id="udaValueClear" onchange="setDirty(true)" value="#{item.udaValue}"
                                         maxlength="#{appBean.descriptionLen}" required="#{item.inputMandatory}"
                                         label="#{item.udaId}" styleClass="form-control form-control-sm"
                                         rendered="#{not item.inputEncrypted}">
                            </h:inputText>
                            <h:inputSecret id="udaValuePassword" onchange="setDirty(true)"
                                           value="#{item.passwordValueToStore}"
                                           maxlength="#{appBean.descriptionLen}" required="#{item.inputMandatory}"
                                           redisplay="true" styleClass="form-control form-control-sm"
                                           label="#{item.udaId}"
                                           rendered="#{item.inputEncrypted}">
                            </h:inputSecret>
                          </rich:column>

                          <f:facet name="footer">
                            <a4j:outputPanel>
                              <adm:pagerBootstrap pagerId="attributePager"/>
                            </a4j:outputPanel>
                          </f:facet>

                          <rich:collapsibleSubTable id="sbtbl" value="#{manageAttributesCtrl.model.attributes}"
                                                    var="item"
                                                    expandMode="client" expanded="#{false}" rows="1">
                            <rich:column colspan="4">
                              <div class="row d-lg-none py-1">
                                <div class="col-4 pl-4">
                                  <h:outputText value="#{msg['marketplace.account.profile.attributes.vendor']}:"
                                                styleClass="font-weight-bold"/>
                                </div>
                                <div class="col-8">
                                  <h:outputText value="#{item.vendor.name}" styleClass="font-weight-bold"/>
                                </div>
                              </div>
                              <tr class="d-none"/>
                              <tr class="d-sm-none">
                                <th colspan="4">
                                  <div class="row d-sm-none p-2">
                                    <div class="col-4">#{msg['marketplace.account.profile.attributes.scope']}:</div>
                                    <div class="col-8">
                                      <h:outputText value="#{msg[scopeKey]}" styleClass="font-weight-bold"/>
                                    </div>
                                  </div>
                                </th>
                              </tr>
                            </rich:column>
                          </rich:collapsibleSubTable>

                        </rich:dataTable>
                      </a4j:outputPanel>

                      <br/>
                      <hr/>
                      <a4j:outputPanel styleClass="row justify-content-end">
                        <adm:buttonBootstrap id="saveAttrButton" value="#{msg['button.save']}"
                                             bean="#{manageAttributesCtrl}"
                                             rendered="#{(not empty manageAttributesCtrl.model.attributes)}"
                                             styleClass="btn btn-secondary mr-4" action="saveAttributes"/>
                      </a4j:outputPanel>
                    </h:form>
                  </div>

                </div>
                <h:form>
                  <a4j:jsFunction name="setSelectedTab">
                    <a4j:param name="param1" assignTo="#{sessionBean.selectedTab}"/>
                  </a4j:jsFunction>
                </h:form>
              </div>

              <script>
        document.addEventListener("DOMContentLoaded", function(){
          $(this).scrollTop(0);
        });

              </script>

              <mp:reloginConfirmPanel/>
            </div>

            <link href="#{facesContext.externalContext.requestContextPath}/css/dataTable.css" rel="stylesheet"
                  type="text/css" media="all"/>

            <script>AdmUtils.sessionTab('#{sessionBean.selectedTab}', 'nav-tab');</script>

          </ui:define>
        </div>
        <div id="settings" class="tab-pane fade show active pt-4" role="tabpanel" aria-labelledby="nav-settings-tab">...
        </div>
      </div>
    </div>

  </div>

</ui:composition>